<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
    <title>CREO|SON - Playground</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/plugins/fontawesome/css/all.css" type="text/css">
    <link rel="stylesheet" href="assets/plugins/prism/prism.css">


    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">

    <link rel="shortcut icon" type="image/png" href="favicon.png"/>

    <style type="text/css" media="screen">
        .editorCreo {
            border: solid;
            border-color: red;
            border-width: 2px;
            width: 100%;
            font-size: 1.1em;
        }
    </style>

    <script> (function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://sc.lfeeder.com/lftracker_v1_Xbp1oaE2VBq8EdVj.js'); })(); </script>
    <script src="assets/creoson_stuff/creoson_js/creoson_creo.js"></script>


</head>

<body class="body-red">

    <nav class="navbar navbar-expand-lg navbar-light">

        <a class="navbar-brand" href="index.html">
            <img src="assets/images/CREOSON.png" style="max-width: 300px">
        </a>

        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fa fa-angle-double-down"></i>
        </button>

        <div class="navbar-collapse collapse justify-content-lg-end mr-lg-3" id="navbarSupportedContent">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            </ul>
        </div>

    </nav>


    <div class="page-wrapper">
        <div class="doc-wrapper">
            <div class="container">
                <div id="doc-header" class="doc-header text-center">
                    <h1 class="doc-title"><span aria-hidden="true" class="icon icon_cogs"></span> Playground</h1>
                </div><!--//doc-header-->

                <div id="showcase" class="doc-body row">
                    <div class="doc-content col-md-9 col-12 order-1">
                        <div class="content-inner">

                            <section id="creosonOverview" class="doc-section">
                                <h2 id="theme-overview" class="section-title">Overview</h2>
                                <div class="section-block">
                                    <p>This web page <span style="color: red;"> does NOT use WebLink! ;)</span></p>
                                    <p><strong>ANY LANGUAGE</strong> could be used to automation Creo with CREOSON using JSON Transactions via HTTP Post!</p>
                                    <p>You can roll your own, or use already available libraries.</p>
                                    <p>Here are some popular options:</p>
                                    <ul>
                                        <li>Python - <a href="https://creopyson.readthedocs.io/en/latest/readme.html" target="_blank">CREOPYSON</a></li>
                                        <li>JavaScript / Node.JS - Source in Directory --> creoson/web/assets/creoson_stuff/creoson_js </li>
                                    </ul>
                                    <p>This page uses the CREOSON JavaScript Library to make JSON requests (using jQuery and AJAX from the Web Browser) to the already running your CREOSON micro-Server.</p>
                                    <p>The CREOSON micro-Server actually executes the JLINK requests into the CREO Parametric Kernel, waits for the Kernel's response, then responds with a JSON Response.</p>
                                    <p>These operations can be executed locally -OR- remotely over a network from other applications!</p>
                                    <p>Give it a TRY!</p>

                                    <p>If you get stuck - or this page is not working... <a href="mailto:support@nitromation.com?Subject=CREOSON Playground NOT Working!">please let us know!</a></p>

                                </div><!--//section-block-->
                            </section><!--//doc-section-->
                            <section id="connectToCreo" class="doc-section">
                                <h2 id="theme-start" class="section-title">Get a sessionId</h2>
                                <div class="section-block">
                                    <p>The first thing you must do is establish a connection to the CREOSON JSON Server, once you have successfully connected, you will get a 'sessionId'.</p>
                                    <p>The sessionId value must be included in ALL subsequent calls/requests to CREO via CREOSON.</p>
                                    <div class="row col-md-offset-1 col-md-12">
                                        
<pre id="editorCreoConn" class="editorCreo">
let sessObj = new creo.ConnectionObj();

sessObj.connect();
</pre>
<button id="aceEvalCreoConnect" type="button" class="btn btn-info">Get a SessionID</button>

                                    </div><!--//row-->
                                </div><!--//section-block-->
                            </section><!--//doc-section-->
                            <section id="openModelSection" class="doc-section creoControls d-none">
                                <h2 class="section-title">Play with some Code!</h2>
                                <div class="section-block">
                                    <p>Just make some recommended changes in the code below and press the Execute Button!</p>
                                    <p>This assumes your current Working directory (or workspace); and can retrieve models from Windchill if connected.</p>
                                    <p>NOTE: Many of the CREOSON commands support *wildcards* as options! (see function help)</p>
                                </div>
                                    <div class="row col-md-offset-1 col-md-12 mb-4">
<pre id="editorCreoOpen" class="editorCreo">
let fileObj = new creo.FileObj();

    fileObj.file = 'test.prt';  //  <<-- ENTER CREO FILE and EXTENSION

    fileObj.display = true;          // true / false
    fileObj.activate = true;         // true / false

    // TRY DIFFERENT COMMANDS
    //  replace the .open() with one of the following...
    //  --> .massprops()
    //  --> .has_instances()
    //  --> .get_mass_units()
    //  --> .get_cur_material()
    //  --> .get_fileinfo()
    //  --> .regenerate()
    //  --> .erase()

    fileObj.open();
    
</pre>
<button id="aceEvalCreoOpen" type="button" class="btn btn-danger">Execute Open Script</button>
                                    </div>

                                <!--START - CREOSON REQUEST-RESPONSE TEMPLATE-->
                                <div id="creoson_requestResponseOpen" class="">
<!--                                    <h5 class="text-center mt-4 mb-4 creosonExampleTitle">Title Placeholder</h5>-->
                                    <div class="row pricing mb-5">

                                        <div class="col-sm-12 col-md-5">
                                            <div class="card" style="background-color: #2d2d2d !important;">
                                                <div class="card-body p-0">
                                                    <div class="heading text-center p-3">JSON Request</div>
                                                    <div class="p-0 creosonExampleRequest" >
                                                        <!--REQUEST TEXT GOES HERE-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="d-none d-md-block col-md-2 text-center">
                                            <i class="fa fa-4x fa-long-arrow-alt-right text-body"></i>
                                        </div>
                                        <div class="d-none d-block d-md-none col-sm-12 text-center">
                                            <i class="fa fa-4x fa-long-arrow-alt-down text-body"></i>
                                        </div>


                                        <div class="col-sm-12 col-md-5">
                                            <div class="card" style="background-color: #2d2d2d !important;">
                                                <div class="card-body p-0">
                                                    <div class="heading text-center p-3">JSON Response</div>
                                                    <div class="creosonExampleResponse">
                                                        <!--RESPONSE TEXT GOES HERE-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--END - CREOSON REQUEST-RESPONSE TEMPLATE-->

                            </section><!--//section-block-->

                            <section id="paramSection" class="doc-section creoControls d-none">
                                <h2 class="section-title">Get some Parameters!</h2>
                                <div class="section-block">
                                    <p>Just make some recommended changes in the code below and press the Execute Button!</p>
                                    <p>This assumes that your model(s) are currently in-session within Creo.</p>
                                    <p>NOTE: THIS is an super flexible function! :)</p>
                                </div>
                                <div class="row col-md-offset-1 col-md-12 mb-4">
<pre id="editorCreoParam" class="editorCreo">
let paramObj = new creo.ParameterObj();

    paramObj.file = '*.prt'; //  <<-- ENTER CREO FILE and EXTENSION (can be wildcard)

    paramObj.name = 'DESC*'     // Parameter 'name' within a Model / Drawing to find  (can be wildcard)
    paramObj.value = '*'        // Parameter 'value' within a Model / Drawing to find  (can be wildcard)
    
    paramObj.list();

</pre>
                                    <button id="aceEvalCreoParam" type="button" class="btn btn-danger">Get Some Parameters</button>
                                </div>

                                <!--START - CREOSON REQUEST-RESPONSE TEMPLATE-->
                                <div id="creoson_requestResponseParams" class="">
                                    <!--                                    <h5 class="text-center mt-4 mb-4 creosonExampleTitle">Title Placeholder</h5>-->
                                    <div class="row pricing mb-5">

                                        <div class="col-sm-12 col-md-5">
                                            <div class="card" style="background-color: #2d2d2d !important;">
                                                <div class="card-body p-0">
                                                    <div class="heading text-center p-3">JSON Request</div>
                                                    <div class="p-0 creosonExampleRequest" >
                                                        <!--REQUEST TEXT GOES HERE-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="d-none d-md-block col-md-2 text-center">
                                            <i class="fa fa-4x fa-long-arrow-alt-right text-body"></i>
                                        </div>
                                        <div class="d-none d-block d-md-none col-sm-12 text-center">
                                            <i class="fa fa-4x fa-long-arrow-alt-down text-body"></i>
                                        </div>


                                        <div class="col-sm-12 col-md-5">
                                            <div class="card" style="background-color: #2d2d2d !important;">
                                                <div class="card-body p-0">
                                                    <div class="heading text-center p-3">JSON Response</div>
                                                    <div class="creosonExampleResponse">
                                                        <!--RESPONSE TEXT GOES HERE-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--END - CREOSON REQUEST-RESPONSE TEMPLATE-->

                            </section><!--//section-block-->



                            <section id="batchExampleSection" class="doc-section creoControls d-none">
                                <h2 class="section-title">Batch Example</h2>
                                <div class="section-block">
                                    <p>This example demonstrates that you CAN easily create your own batch execution processes with CREOSON.</p>
                                    <p>NOTE: You <i>can</i> enter wildcard values for model/drawing names / extensions as a test. :)</p>
                                </div>
                                <div class="row col-md-offset-1 col-md-12 mb-4">
<pre id="editorBatchExample" class="editorCreo">
function processItem(itemName) {

    let fileObj = new creo.FileObj();
    fileObj.display = true;
    fileObj.activate = true;
    fileObj.file = itemName;

    return fileObj.open();

}

function batchFiles () {

    let creoObj = new creo.CreoObj();
    let creosonUtilObj = new creo.CreosonUtils();

    creoObj.filename = "*.drw";  // <<-- ENTER CREO FILE (*) and EXTENSION
    
    creoObj.list_files()
        .then(function (respObj) {
            return creosonUtilObj.loopItems(respObj.filelist, processItem)
        })
        .then(function () {
            alert("Finished Batching!");
        })
        .catch((err) => {
            alert('ERROR: '+err);
        });

}

// START THE BATCH PROCESS!
batchFiles();

</pre>
<button id="aceEvalBatchExample" type="button" class="btn btn-danger">Execute Batch Script</button>

                                </div>

                            </section>





                        </div><!--//content-inner-->

                    </div><!--//doc-content-->
                    <div class="doc-sidebar col-md-3 col-12 order-0 d-none d-md-flex">
                        <div id="doc-nav" class="doc-nav">

                            <nav id="doc-menu" class="nav doc-menu flex-column sticky">
                                <a class="nav-link scrollto" href="#creosonOverview">Overview</a>
                                <a class="nav-link" href="#connectToCreo">Live Code Example</a>
                                <nav class="doc-sub-menu nav flex-column">
                                    <a class="nav-link scrollto" href="#connectToCreo">Get a sessionId</a>
                                    <a class="nav-link scrollto" href="#openModelSection">Play with some Code!</a>
                                    <a class="nav-link scrollto" href="#paramSection">Get some Parameters!</a>
                                    <a class="nav-link scrollto" href="#batchExampleSection">Batch Example</a>
                                </nav>
                                <a class="nav-link scrollto" href="#promo-block">Commercial Tools</a>
                                <nav class="doc-sub-menu nav flex-column">
                                    <a class="nav-link scrollto" href="#promo-block">Automate w/ Excel</a>
                                    <a class="nav-link scrollto" href="#promo-block">BOM Automation</a>
                                    <a class="nav-link scrollto" href="#promo-block">Pro/PROGRAM</a>
                                </nav>
                            </nav><!--//doc-menu-->

                        </div>
                    </div>
                    </div><!--//doc-sidebar-->
                </div><!--//doc-body-->
            </div><!--//container-->
        </div><!--//doc-wrapper-->
    </div> <!--//page-wrapper-->


    <div id="promo-block" class="promo-block pt-4 pb-2">
        <div class="container">
            <h3 class="section-heading text-center">
                <i class="fa fa-heart text-white"></i>
                <a href="http://www.simplifiedlogic.com" class="card-link text-white" target="_blank"><span class="d-none d-md-inline">Awesome</span> Creo Automation Apps!</a></h3>

            <div class="row pricing justify-content-center">

                <div class="col-md-5 col-lg-4 mb-4">
                    <div class="card">
                        <div class="card-body p-0">
                            <div class="heading text-center p-3">
                                <h4 class="text-white mb-2">Automate w/ Excel!</h4>
                                <a href="https://www.simplifiedlogic.com/nitro-cell" target="_blank"><img class="img-fluid" src="assets/images/nitro-logos/Nitro-CELL_Logo.png" style="max-height: 30px"/></a>
                            </div>
                            <div class="info p-3 text-body">
                                <div class="desc px-3">
                                    <a href="https://www.simplifiedlogic.com/nitro-cell" target="_blank"><img class="img-fluid" src="assets/images/commercial/cell_sample.jpg" style="width:100%"/></a>
                                </div>
                                <div class="desc px-0 text-body mt-3 d-none d-md-inline-flex">
                                    <a class="btn btn-primary" href="http://download.nitromation.com/osgi/Nitro-CELL-win64.zip" target="_blank"><i class="fa fa-cloud-download-alt"></i> Download</a>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-md-5 col-lg-4 mb-4">
                    <div class="card">
                        <div class="card-body p-0">
                            <div class="heading text-center p-3">
                                <h4 class="text-white mb-2">BOM Automation!</h4>
                                <a href="https://www.simplifiedlogic.com/nitro-bom" target="_blank"><img class="img-fluid" src="assets/images/nitro-logos/Nitro-BOM_Logo.png" style="max-height: 30px"/></a>
                            </div>
                            <div class="info p-3 text-body">
                                <div class="desc px-3">
                                    <a href="https://www.simplifiedlogic.com/nitro-bom" target="_blank"><img class="img-fluid" src="assets/images/commercial/bom_sample.jpg"/></a>
                                </div>
                                <div class="desc px-0 text-body mt-3 d-none d-md-inline-flex">
                                    <a class="btn btn-primary" href="http://download.nitromation.com/osgi/Nitro-BOM-win64.zip" target="_blank"><i class="fa fa-cloud-download-alt"></i> Download</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-5 col-lg-4 mb-4">
                    <div class="card">
                        <div class="card-body p-0">
                            <div class="heading text-center p-3">
                                <h4 class="text-white mb-2">Pro/PROGRAM</h4>
                                <a href="https://www.simplifiedlogic.com/nitro-program" target="_blank"><img class="img-fluid" src="assets/images/nitro-logos/Nitro-PROGRAM_Logo.png"  style="max-height: 30px"/></a>
                            </div>
                            <div class="info p-3 text-body">
                                <div class="desc px-3">
                                    <a href="https://www.simplifiedlogic.com/nitro-program" target="_blank"><img class="img-fluid" src="assets/images/commercial/program_sample.jpg"/></a>
                                </div>
                                <div class="desc px-0 text-body mt-3 d-none d-md-inline-flex">
                                    <a class="btn btn-primary" href="http://download.nitromation.com/osgi/Nitro-PROGRAM-win64.zip" target="_blank"><i class="fa fa-cloud-download-alt"></i> Download</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div><!--//pricing-->
        </div><!--//container-->
    </div><!--//promo-block-->




<footer class="footer text-center">
    <div class="container">
        <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can check out other license options via our website: themes.3rdwavemedia.com */-->

        <small class="copyright">CREOSON is NOT affiliated with PTC - so please do NOT contact PTC for Support!</small><br>
        <small class="copyright">CREOSON was developed and OpenSourced by Simplified Logic, Inc. Google Analytics used only for Documentation Usage</small><br>
        <small class="copyright">This Site was Perfectly Designed with <i class="fa fa-heart"></i> by <a href="http://themes.3rdwavemedia.com/" target="_blank">Xiaoying Riley</a>.</small>

    </div><!--//container-->
</footer><!--//footer-->


<!--SPECIAL THANKS TO MSIE FOR -NOT- SUPPORTING NATIVE PROMISE EXECUTIONS! :( -->
<script type="text/javascript" src="assets/plugins/bluebird/bluebird.js"></script>

<!-- Main Javascript -->
<script type="text/javascript" src="assets/plugins/jquery_3.4.1/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/plugins/prism/prism.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery-match-height/jquery.matchHeight-min.js"></script>
<script type="text/javascript" src="assets/js/main.js"></script>

<!-- CREOSON_JS Libraries -->
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/common_creoson_ajax.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/common_creoson_utils.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_bom.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_connection.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_creo.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_dimension.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_drawing.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_familytable.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_feature.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_file.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_geometry.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_interface.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_layer.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_note.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_parameter.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_view.js"></script>
<script type="text/javascript" src="assets/creoson_stuff/creoson_js/creoson_windchill.js"></script>

    
<!--CREOSON DEMO CODE-->
<script>

    function disableBatchButton() {
        return new Promise (function (resolve, reject) {
            $("#aceEvalBatchExample")
                .removeClass('btn-danger')
                .addClass('btn-warning')
                .text("processing...")
                .prop('disabled',true);
            // stupid need to wait for update!
            setTimeout(resolve, 400);
        })
    }

    function executeBatch() {

        disableBatchButton()
            .then(function () {
                try {
                    var code = editorBatchExample.getValue();
                    eval(code)
                } catch(err) {
                    alert('ERROR EVALUATING : '+err);
                } finally {
                    $("#aceEvalBatchExample")
                        .removeClass('btn-warning')
                        .addClass('btn-danger')
                        .text('Execute Batch Script')
                        .prop('disabled',false);
                }
            })


    }

    
    // initialize the events
    $().ready(


        $('#aceEvalCreoConnect')
            .off('click')
            .on('click', function () {
                let self = this;
                try {
                    var code = editorCreoConn.getValue();
                    eval(code)
                        .then(() => {
                            $(self)
                                .text("Connection Successful  (sessionId = "+creo.ajax.sessionId+")")
                                .removeClass('btn-info')
                                .addClass('btn-success')
                                .off('click')
                                .on('click', function () {
                                    alert("refresh page to get new connection!")
                                });

                            $('#openModelSection')
                                .removeClass('d-none');
                            $('#paramSection')
                                .removeClass('d-none');
                            $('#batchExampleSection')
                                .removeClass('d-none');
                        })
                        .catch((err) => {
                            $(self)
                                .text("Connection FAILED")
                                .removeClass('btn-success')
                                .addClass('btn-danger')
                                .off('click')
                                .on('click', function () {
                                    alert("refresh page to get new connection!")
                                });
                        });
                } catch(err) {
                    $(self)
                        .text("Connection FAILED")
                        .removeClass('btn-success')
                        .addClass('btn-danger')
                        .off('click')
                        .on('click', function () {
                            alert("refresh page to get new connection!")
                        });
                }
                
            }),

        $('#aceEvalCreoOpen')
            .off('click')
            .on('click', function () {
                try {
                    let self = this;
                    var code = editorCreoOpen.getValue();
                    eval(code)
                        .then((resObj) => {
                            console.log('---_ GO TTHIS BACK _----');
                            console.log(JSON.stringify(resObj,null,2));
                            $('#editorCreoOpenResponse').empty().append(JSON.stringify(resObj,null,2));

                            // cleanup last reqeust for presetnation - hack!  but works :)
                            let prettyRequest = JSON.parse(JSON.stringify(creo.ajax.lastRequestObj));
                            prettyRequest = JSON.parse(prettyRequest.data);

                            $('#creoson_requestResponseOpen')
                                .find('.creosonExampleRequest')
                                .empty()
                                .append(
                                    $('<pre>')
                                        .css('max-height', "350px")
                                        .append(
                                            $('<code>')
                                                .addClass('language-json')
                                                .append(JSON.stringify(prettyRequest, null, 2))
                                        )
                                );
                            
                            $('#creoson_requestResponseOpen')
                                .find('.creosonExampleResponse')
                                .empty()
                                .append(
                                    $('<pre>')
                                        .css('max-height', "350px")
                                        .append(
                                            $('<code>')
                                                .addClass('language-json')
                                                .append(JSON.stringify(resObj, null, 2))
                                        )
                                );

                            $(self)
                                .text("Execution Successful")
                                .removeClass('btn-danger')
                                .addClass('btn-success');

                            // reset the button
                            setTimeout(function () {
                                $(self)
                                    .text("Execute Again")
                                    .removeClass('btn-success')
                                    .addClass('btn-danger');
                            }, 2000);

                            // make it pretty!
                            Prism.highlightAll();

                        })
                    .catch((err) => {
                        if (err.status) {
                            alert('failed to execute: '+err.status.message);
                        } else {
                            alert('failed to execute: '+err);
                        }

                    });
                } catch(err) {
                    alert('failed to execute : '+err);
                }


            }),

        $('#aceEvalCreoParam')
            .off('click')
            .on('click', function () {
                try {
                    let self = this;
                    var code = editorCreoParam.getValue();
                    eval(code)
                        .then((resObj) => {
                            console.log('---_ GO TTHIS BACK _----');
                            console.log(JSON.stringify(resObj,null,2));
                            $('#editorCreoOpenResponse').empty().append(JSON.stringify(resObj,null,2));

                            // cleanup last reqeust for presetnation - hack!  but works :)
                            let prettyRequest = JSON.parse(JSON.stringify(creo.ajax.lastRequestObj));
                            prettyRequest = JSON.parse(prettyRequest.data);

                            $('#creoson_requestResponseParams')
                                .find('.creosonExampleRequest')
                                .empty()
                                .append(
                                    $('<pre>')
                                        .css('max-height', "350px")
                                        .append(
                                            $('<code>')
                                                .addClass('language-json')
                                                .append(JSON.stringify(prettyRequest, null, 2))
                                        )
                                );

                            $('#creoson_requestResponseParams')
                                .find('.creosonExampleResponse')
                                .empty()
                                .append(
                                    $('<pre>')
                                        .css('max-height', "350px")
                                        .append(
                                            $('<code>')
                                                .addClass('language-json')
                                                .append(JSON.stringify(resObj, null, 2))
                                        )
                                );

                            $(self)
                                .text("Execution Successful")
                                .removeClass('btn-danger')
                                .addClass('btn-success');

                            // reset the button
                            setTimeout(function () {
                                $(self)
                                    .text("Execute Again")
                                    .removeClass('btn-success')
                                    .addClass('btn-danger');
                            }, 2000);

                            // make it pretty!
                            Prism.highlightAll();

                        })
                        .catch((err) => {
                            if (err.status) {
                                alert('failed to execute: '+err.status.message);
                            } else {
                                alert('failed to execute: '+err);
                            }

                        });
                } catch(err) {
                    alert('failed to execute : '+err);
                }


            }),




        $('#aceEvalBatchExample')
            .off('click')
            .on('click', function() {

                $("#aceEvalBatchExample")
                    .removeClass('btn-danger')
                    .addClass('btn-warning')
                    .text("processing...")
                    .prop('disabled',true);
                // stupid need to wait for page update!
                setTimeout(function () {

                    try {
                        var code = editorBatchExample.getValue();
                        eval(code)
                    } catch(err) {
                        alert('ERROR EVALUATING : '+err);
                    } finally {
                        $("#aceEvalBatchExample")
                            .removeClass('btn-warning')
                            .addClass('btn-danger')
                            .text('Execute Batch Script')
                            .prop('disabled',false);
                    }

                }, 400);

            })

    );

    // set the port number
        creo.ajax.port = parseInt(window.location.port);
        console.log('creoson Port: ' + creo.ajax.port);
    
</script>



<script src="assets/plugins/aceEditor/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>

    var editorCreoConn = new ace.edit("editorCreoConn", {
        minLines: 2,
        maxLines: 30,
        useWorker : false
    });
    editorCreoConn.setTheme("ace/theme/xcode");
    editorCreoConn.session.setMode("ace/mode/javascript");

    var editorCreoOpen = new ace.edit("editorCreoOpen", {
        minLines: 2,
        maxLines: 30,
        useWorker : false
    });
    editorCreoOpen.setTheme("ace/theme/xcode");
    editorCreoOpen.session.setMode("ace/mode/javascript");

    var editorCreoParam = new ace.edit("editorCreoParam", {
        minLines: 2,
        maxLines: 30,
        useWorker : false
    });
    editorCreoParam.setTheme("ace/theme/xcode");
    editorCreoParam.session.setMode("ace/mode/javascript");


    var editorBatchExample = new ace.edit("editorBatchExample", {
        minLines: 2,
        maxLines: 30,
        useWorker : false
    });
    editorBatchExample.setTheme("ace/theme/xcode");
    editorBatchExample.session.setMode("ace/mode/javascript");






</script>



    <!-- Start of HubSpot Embed Code -->
    <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/6222371.js"></script>
    <!-- End of HubSpot Embed Code -->


    <!--GOOGLE ANALYTICS-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-101614187-1', 'auto');
        ga('send', 'pageview');

    </script>


</body>


</html>

